Option ExplicitnnnPrivate asset1_() As StringnPrivate asset2_() As StringnPrivate corr_() As DoublenPrivate corr_origin_() As Doublen'Private min_corr_() As Double 'local correlation 추가 2019.3.27nnPublic Function copy_obj() As clsCorrelationPairsnn    Dim inx As Integern    Dim no_of_assets As Integern    Dim rtn_obj As clsCorrelationPairsnnOn Error Resume Nextnn    no_of_assets = UBound(asset1_)n    n    If Err.number = 8 Thenn        no_of_assets = 0n    End IfnnOn Error GoTo ErrorHandlernn    Set rtn_obj = New clsCorrelationPairsn    n    For inx = 1 To no_of_assetsn    n        rtn_obj.set_corr asset1_(inx), asset2_(inx), corr_(inx)n        'rtn_obj.set_min_corr asset1_(inx), asset2_(inx), min_corr_(inx) 'local correlation 추가 2019.3.27n        n    Next inxn    n    Set copy_obj = rtn_objn    n    Exit Functionn    nErrorHandler:nn    raise_err "clsCorrelationPairs.get_corr", Err.descriptionnnEnd FunctionnnnPublic Function rewind(asset_name_1 As String, asset_name_2 As String)nn    Dim inx As Integern    n    nOn Error GoTo ErrorHandlernn    inx = find_pair(asset_name_1, asset_name_2)n    n    If inx > 0 Thenn    n        set_corr asset_name_1, asset_name_2, corr_origin_(inx)n        n    End Ifnn    Exit Functionn    nErrorHandler:nn    raise_err "bump_corr", Err.descriptionnnEnd FunctionnnnPublic Function bump_corr(asset_name_1 As String, asset_name_2 As String, bump_value As Double)nn    Dim inx As Integern    n    nOn Error GoTo ErrorHandlernn    inx = find_pair(asset_name_1, asset_name_2)n    n    If inx > 0 Thenn    n        set_corr asset_name_1, asset_name_2, corr_(inx) + bump_valuen        n    End Ifnn    Exit Functionn    nErrorHandler:nn    raise_err "bump_corr", Err.descriptionnnEnd FunctionnnPublic Function get_corr(asset_name_1 As String, asset_name_2 As String) As Doublenn    Dim inx As Integern    Dim rtn_value As Doublen    nOn Error GoTo ErrorHandlern            n    inx = find_pair(asset_name_1, asset_name_2)n    n    If inx > 0 Thenn    n        rtn_value = corr_(inx)n    n    Elsen    n        rtn_value = 0n        n    End Ifn    n    get_corr = rtn_valuen    n    Exit Functionn    nErrorHandler:nn    raise_err "clsCorrelationPairs.get_corr", Err.descriptionn    nnEnd Functionnn'local correlation 추가 2019. 3. 27n'Public Function get_min_corr(asset_name_1 As String, asset_name_2 As String) As Doublen'n'    Dim inx As Integern'    Dim rtn_value As Doublen'n'On Error GoTo ErrorHandlern'n'    inx = find_pair(asset_name_1, asset_name_2)n'n'    If inx > 0 Thenn'n'        rtn_value = min_corr_(inx)n'n'    Elsen'n'        rtn_value = 0n'n'    End Ifn'n'    get_min_corr = rtn_valuen'n'    Exit Functionn'n'ErrorHandler:n'n'    raise_err "clsCorrelationPairs.get_min_corr", Err.descriptionn'n'n'End FunctionnnPublic Sub set_corr(asset_name_1 As String, asset_name_2 As String, corr As Double)n    n    Dim inx As Integern    nOn Error GoTo ErrorHandlern    n    inx = find_pair(asset_name_1, asset_name_2)n    n    If inx <= 0 Thenn    n        push_back_string asset1_, asset_name_1n        push_back_string asset2_, asset_name_2n        push_back_double corr_, corrn        push_back_double corr_origin_, corrn        n    Elsen        n        corr_(inx) = corrn        'corr_origin_(inx) = corrn    n    End Ifn    nn    Exit Subn    nErrorHandler:nn    raise_err "clsCorrelationPairs.set_corr", Err.descriptionn    nnEnd Subnn'local correlation 추가 2019. 3. 27n'Public Sub set_min_corr(asset_name_1 As String, asset_name_2 As String, min_corr As Double)n'n'    Dim inx As Integern'n'On Error GoTo ErrorHandlern'n'    inx = find_pair(asset_name_1, asset_name_2)n'n'    If inx <= 0 Thenn'n'        push_back_string asset1_, asset_name_1n'        push_back_string asset2_, asset_name_2n'        push_back_double min_corr_, min_corrn'n'    Elsen'n'        min_corr_(inx) = min_corrn'        'corr_origin_(inx) = corrn'n'    End Ifn'n'n'    Exit Subn'n'ErrorHandler:n'n'    raise_err "clsCorrelationPairs.set_min_corr", Err.descriptionn'n'n'End SubnnnPrivate Function find_pair(asset_name_1 As String, asset_name_2 As String) As Integernn    Dim inx As Integern    Dim rtn_value As Integern    Dim no_of_pairs As Integern    nOn Error Resume Nextnn    no_of_pairs = UBound(asset1_)n    n    n    If Err.number = 9 Thenn    n        rtn_value = 0n        n    Elsen    nOn Error GoTo ErrorHandlern            n        For inx = 1 To no_of_pairsn        n            If (asset_name_1 = asset1_(inx) And asset_name_2 = asset2_(inx)) _n            Or (asset_name_1 = asset2_(inx) And asset_name_2 = asset1_(inx)) Thenn            n                rtn_value = inxn                Exit Forn            n            End Ifn        n        Next inxn        n    End Ifn    n    find_pair = rtn_valuen    n    Exit Functionn    nErrorHandler:nn    raise_err "clsCorrelationPairs.find_pair", Err.descriptionn    nnEnd Function