Option ExplicitnnPublic prod_code As StringnPublic prod_type As StringnPublic ul_code As StringnPublic option_type As Long ' 0: European / 1: AmericannPublic call_put As Long '0: call / 1: putnPublic k As Double 'strike pricenPublic maturity_date As Date 'maturity date as date typenPublic qty As Double ' number of contractsnPublic conversion_ratio As Double 'multipliernPublic ul_currency As StringnPublic face_value As DoublenPublic option_on_futures As BooleannPublic futures_maturity As DatennnPublic Sub initialize(ByVal prod_code_in As String, _n                    ByVal prod_type_in As String, _n                    ByVal ul_code_in As String, _n                    ByVal maturity_date_in As Date, _n                    ByVal k_in As Double, _n                    ByVal qty_in As Double, _n                    ByVal conversion_ratio_in As Double, _n                    ByVal ul_currency_in As String, _n                    Optional ByVal option_type_in As Long = 0, _n                    Optional ByVal option_on_futures_in As Boolean = False, _n                    Optional ByVal futures_maturity_in As Date = -1)n    n    prod_code = prod_code_inn    prod_type = prod_type_inn    n    Select Case prod_typen    Case "C": call_put = 0n    Case "P": call_put = 1n    Case Else: call_put = -1n    End Selectn    n    ul_code = ul_code_inn    maturity_date = maturity_date_inn    k = k_inn    qty = qty_inn    conversion_ratio = conversion_ratio_inn    ul_currency = ul_currency_inn    option_type = option_type_inn    option_on_futures = option_on_futures_inn    futures_maturity = futures_maturity_inn    n    'for NYSE stock options : 2024.07.25n    ul_code = Replace(ul_code, ".NS", "", , , vbTextCompare)n    n    'for S&P500 mini-optionsn    If Left(ul_code_in, 2) = "ES" And ul_currency_in = "USD" Thenn        option_type = 1 'Americann        option_on_futures = Truen        ul_code = get_ua_code(ua.SPX)n    End IfnnEnd Sub