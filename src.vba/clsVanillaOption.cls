Option Explicitnn'------------------------------------------------------------------------n' CLASS : clsVanillaOptionn' DESC :Simple Vanilla Option Class. Contains pricing functionality in itself.n' Dependence: mdl_2_vanilla, mdl_common, clsRateCurve, clsDividendSchedule, clsGreeksn'------------------------------------------------------------------------nnPrivate Const pl_currency As String = "KRW" ' PL Currencynn'-------------------------------------------n' Deal informationn'-------------------------------------------nPublic ul_price As DoublenPublic k As Double 'Strike PricenPublic call_put As String ' Call / Put TypenPublic maturity_date As Date 'maturity date as date typenPublic qty As Double ' Number of optionsnPublic open_position As Double ' Number of options at the beginning of the day.nPublic conversion_ratio As Double 'Conversion ratio. Maybe 500,000 for KOSPI2.nPublic face_value As DoublennPublic bl_code As StringnnPublic option_type As String ' European / AmericannnPublic option_on_futures As BooleannPublic futures_maturity As DatennnnPublic ul_currency As String ' UL Currency. Optional.nn'-------------------------------------------n' Booking information.n'-------------------------------------------nPublic asset_code As StringnPublic fund_code_m As StringnPublic fund_code_c As StringnPublic ul_code As StringnPublic ul_name As StringnPublic trade_date As DatenPublic ul_initial_price As Double ' This is NOT the current ul price, but the ul price at the deal inception.nPublic deal_type As String  'Futures / Listed Option / ELWnnPublic underlying_type As StringnnPublic unit_qty As DoublennPublic broker As StringnnPrivate t As DoublennPrivate functions_ As New FunctionsnnPublic Function ul_code_as_array() As String()nn    Dim rtn_array(1 To 1) As Stringn    n    n    If UCase(Left(ul_code, 2)) = "ES" Thenn        rtn_array(1) = "SPX"n    Elsen        rtn_array(1) = ul_coden    End Ifn    n    ul_code_as_array = rtn_arraynnEnd Functionnnn'====================================================================================n' Sub: initializen' DESC: Initializern'====================================================================================nPublic Sub initialize(ByVal maturity_date_in As Date, ByVal k_in As Double, ByVal qty_in As Double, ByVal open_position_in As Double, ByVal conversion_ratio_in As Double, ByVal call_put_in As String _n                     , Optional ByVal ul_currency_in As String = "KRW" _n                     , Optional ByVal option_type_in As String = "European" _n                     , Optional option_on_futures_in As Boolean = False _n                     , Optional futures_maturity_in As Date = -1 _n                     )n                     nnn    k = k_inn    call_put = call_put_inn    maturity_date = maturity_date_inn    qty = qty_inn    open_position = open_position_inn    conversion_ratio = conversion_ratio_inn    ul_currency = ul_currency_inn    option_type = option_type_inn    option_on_futures = option_on_futures_inn    n    If futures_maturity_in > 0 Thenn        futures_maturity = futures_maturity_inn    Elsen        futures_maturity = maturity_daten    End IfnnnEnd Sub