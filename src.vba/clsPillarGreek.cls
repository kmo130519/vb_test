Option ExplicitnnPrivate greek_value_ As DoublennPublic date_location As IntegernPublic strike_location As IntegernPublic greek_type As StringnnPrivate strike_ As DoublenPrivate maturity_ As DatenPrivate strike_abs_() As DoublenPrivate date_abs_() As DatennPublic greek_1_1 As DoublenPublic greek_1_2 As DoublenPublic greek_2_1 As DoublenPublic greek_2_2 As DoublennnPublic Sub set_input_greek(greek_type As String, greek_value As Double, strike_abs() As Double, date_abs() As Date, strike As Double, Maturity As Date)nn    strike_abs_ = strike_absn    date_abs_ = date_absn    greek_value_ = greek_valuen    n    strike_ = striken    maturity_ = Maturityn    Me.greek_type = greek_typen    nnEnd SubnnPublic Sub split_greek()n                     nn    '---------------------------------------n    ' Handle the boundariesn    '---------------------------------------n    If maturity_ < date_abs_(LBound(date_abs_)) Thenn        maturity_ = date_abs_(LBound(date_abs_))n    ElseIf maturity_ > date_abs_(UBound(date_abs_)) Thenn        maturity_ = date_abs_(UBound(date_abs_))n    End Ifn                     n    If strike_ < strike_abs_(LBound(strike_abs_)) Thenn        strike_ = strike_abs_(LBound(strike_abs_))n    ElseIf strike_ > strike_abs_(UBound(strike_abs_)) Thenn        strike_ = strike_abs_(UBound(strike_abs_))n    End Ifnn    date_location = find_location_date(date_abs_, maturity_)n    strike_location = find_location(strike_abs_, strike_)n    n    greek_1_1 = (strike_abs_(strike_location + 1) - strike_) * (date_abs_(date_location + 1) - maturity_) _n             / (strike_abs_(strike_location + 1) - strike_abs_(strike_location)) / (date_abs_(date_location + 1) - date_abs_(date_location)) _n             * greek_value_n    greek_1_2 = (strike_ - strike_abs_(strike_location)) * (date_abs_(date_location + 1) - maturity_) _n              / (strike_abs_(strike_location + 1) - strike_abs_(strike_location)) / (date_abs_(date_location + 1) - date_abs_(date_location)) _n              * greek_value_n    greek_2_1 = (strike_abs_(strike_location + 1) - strike_) * (maturity_ - date_abs_(date_location)) _n             / (strike_abs_(strike_location + 1) - strike_abs_(strike_location)) / (date_abs_(date_location + 1) - date_abs_(date_location)) _n             * greek_value_n    greek_2_2 = (strike_ - strike_abs_(strike_location)) * (maturity_ - date_abs_(date_location)) _n             / (strike_abs_(strike_location + 1) - strike_abs_(strike_location)) / (date_abs_(date_location + 1) - date_abs_(date_location)) _n             * greek_value_nnnEnd Subn