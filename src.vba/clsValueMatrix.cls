Option ExplicitnnnPrivate xAxis_vol_bump_() As DoublenPrivate yAxis_vol_bump_() As DoublenPrivate zAxis_vol_bump_() As DoublenPrivate snapshot_value_vol_bump_() As Doublen'Private snapshot_value_vol_bump_() As Doublen'Private snapshot_value_skew_bump_() As DoublennnnPublic Function get_xAxis_vol_bump() As Double()nn    get_xAxis_vol_bump = xAxis_vol_bump_nnEnd FunctionnnPublic Function get_yAxis_vol_bump() As Double()nn    get_yAxis_vol_bump = yAxis_vol_bump_nnEnd FunctionnPublic Function get_zAxis_vol_bump() As Double()nn    get_zAxis_vol_bump = zAxis_vol_bump_nnEnd FunctionnPublic Function get_snapshot_value_vol_bump() As Double()nn    get_snapshot_value_vol_bump = snapshot_value_vol_bump_nnEnd Functionn'Public Function gennnnPublic Sub set_xAxis_vol_bump(xAxis() As Double, Optional log_value As Boolean = True, Optional as_percentage_of As Double = 1#)n    n    Dim inx As Integern    nOn Error Resume Nextnn    ReDim xAxis_vol_bump_(LBound(xAxis) To UBound(xAxis)) As Doublen    nOn Error GoTo ErrorHandlern    n    If Err.number = 9 Thenn        n        raise_err "set_xAxis", "xAxis not initialized.."n    n    End Ifn    n    If log_value Thenn    n        For inx = LBound(xAxis) To UBound(xAxis)n            n            xAxis_vol_bump_(inx) = Exp(xAxis(inx)) / as_percentage_ofn        n        Next inxn    n    Elsen    n        For inx = LBound(xAxis) To UBound(xAxis)n        n            xAxis_vol_bump_(inx) = xAxis(inx) / as_percentage_ofn            n        Next inxn        n    End Ifn    n    Exit Subn    nErrorHandler:nn    raise_err "set_xAxis"nnnEnd SubnnnPublic Sub set_yAxis_vol_bump(yAxis() As Double, Optional log_value As Boolean = True, Optional as_percentage_of As Double = 1#)n    n    Dim inx As Integern    nOn Error Resume Nextnn    ReDim yAxis_vol_bump_(LBound(yAxis) To UBound(yAxis)) As Doublen    nOn Error GoTo ErrorHandlern    n    If Err.number = 9 Thenn        n        raise_err "set_yAxis", "yAxis not initialized.."n    n    End Ifn    n    If log_value Thenn    n        For inx = LBound(yAxis) To UBound(yAxis)n            n            yAxis_vol_bump_(inx) = Exp(yAxis(inx)) / as_percentage_ofn        n        Next inxn    n    Elsen        n        For inx = LBound(yAxis) To UBound(yAxis)n            n            yAxis_vol_bump_(inx) = (yAxis(inx)) / as_percentage_ofn        n        Next inxn        n    End Ifn    n    Exit Subn    nErrorHandler:nn    raise_err "set_yAxis"nnnEnd SubnPublic Sub set_zAxis_vol_bump(zAxis() As Double, Optional log_value As Boolean = True, Optional as_percentage_of As Double = 1#)n    n    Dim inx As Integern    nOn Error Resume Nextnn    ReDim zAxis_vol_bump_(LBound(zAxis) To UBound(zAxis)) As Doublen    nOn Error GoTo ErrorHandlern    n    If Err.number = 9 Thenn        n        raise_err "set_zAxis", "yAxis not initialized.."n    n    End Ifn    n    If log_value Thenn    n        For inx = LBound(zAxis) To UBound(zAxis)n            n            zAxis_vol_bump_(inx) = Exp(zAxis(inx)) / as_percentage_ofn        n        Next inxn    n    Elsen        n    n        For inx = LBound(zAxis) To UBound(zAxis)n            n            zAxis_vol_bump_(inx) = (zAxis(inx)) / as_percentage_ofn        n        Next inxn        n    End Ifn    n    Exit Subn    nErrorHandler:nn    raise_err "set_zAxis"nnnEnd SubnnPublic Sub set_snapshot_value_bump(snapshot_value() As Double, Optional notional As Double = 1)n    n    Dim inx As Longn    nOn Error Resume Nextnn    ReDim snapshot_value_vol_bump_(LBound(snapshot_value) To UBound(snapshot_value)) As Doublen    nOn Error GoTo ErrorHandlern    n    If Err.number = 9 Thenn        n        raise_err "set_snapshot_value", "snapshot_value_ not initialized.."n    n    End Ifn    n   n   For inx = LBound(snapshot_value) To UBound(snapshot_value)n            n        snapshot_value_vol_bump_(inx) = snapshot_value(inx) * notionaln        n   Next inxn    n    Exit Subn    nErrorHandler:nn    raise_err "set_snaptshot_value", Err.descriptionnnnEnd SubnnnPublic Sub set_snapshot_value_vol_bump(snapshot_value() As Double, Optional notional As Double = 1)n    n    Dim inx As Longn    nOn Error Resume Nextnn    ReDim snapshot_value_vol_bump_(LBound(snapshot_value) To UBound(snapshot_value)) As Doublen    nOn Error GoTo ErrorHandlern    n    If Err.number = 9 Thenn        n        raise_err "set_snapshot_value", "snapshot_value_ not initialized.."n    n    End Ifn    n   n   For inx = LBound(snapshot_value) To UBound(snapshot_value)n            n        snapshot_value_vol_bump_(inx) = snapshot_value(inx) * notionaln        n   Next inxn    n    Exit Subn    nErrorHandler:nn    raise_err "set_snaptshot_value", Err.descriptionnnnEnd Sub